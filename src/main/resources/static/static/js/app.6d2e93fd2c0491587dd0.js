webpackJsonp([11],{"9uPt":function(e,t){},IcnI:function(e,t,n){"use strict";var o=n("BO1k"),r=n.n(o),u=n("d7EF"),a=n.n(u),s=n("mvHQ"),l=n.n(s),i=n("ifoU"),c=n.n(i),g=n("7+uW"),f=n("NYxO"),m="ws://81.70.38.35:8090/chat/";g.default.use(f.a);var d={sessionId:null,user:{userId:null,nickname:null,intro:null,avater:null,gmtCreate:null,authority:null,sex:null}},p=new f.a.Store({state:{loginResult:d,chatWebSocket:null,messageGroup:new c.a,messageCount:0,isChat:!1,valueChange:new Date},mutations:{init:function(e){var t,n,o=JSON.parse(localStorage.getItem("loginResult"));if(e.messageCount=0,null!=o){e.loginResult=o;var r=JSON.parse(localStorage.getItem("messageGroup"));null!=r&&r.forEach(function(t){e.messageGroup.set(t[0],t[1]),t[1].forEach(function(t){!0===t.unread&&t.dstId===e.loginResult.user.userId&&++e.messageCount})}),e.chatWebSocket=(t=o.sessionId,(n=new WebSocket(m+t)).onopen=function(e){console.log("聊天服务开启")},n.onclose=function(e){console.log("聊天服务关闭")},n.onmessage=function(e){var t=JSON.parse(e.data);t instanceof Array?t.forEach(function(e){h.commit("receiveMessage",e)}):h.commit("receiveMessage",t)},n)}},logout:function(e){localStorage.removeItem("loginResult"),localStorage.removeItem("messageGroup"),e.loginResult=d,e.messageGroup=new c.a,e.chatWebSocket.close(),e.chatWebSocket=null},receiveMessage:function(e,t){var n=e.messageGroup,o=t.srcId;o===e.loginResult.user.userId?o=t.dstId:e.isChat?t.unread=!1:++e.messageCount;var r=n.get(o);null==r?(n.set(o,[t]),e.valueChange=new Date):r.push(t),localStorage.setItem("messageGroup",l()(n))},readMessage:function(e){e.isChat=!0,e.messageCount=0;var t=e.messageGroup,n=!0,o=!1,u=void 0;try{for(var s,i=r()(t);!(n=(s=i.next()).done);n=!0){var c=s.value,g=a()(c,2);g[0];g[1].forEach(function(e){e.unread=!1})}}catch(e){o=!0,u=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw u}}localStorage.setItem("messageGroup",l()(t))},closeMessage:function(e){e.isChat=!1},setUser:function(e,t){e.loginResult.user=t,localStorage.setItem("loginResult",l()(e.loginResult))},setInfo:function(e,t){var n=e.loginResult.user;n.nickname=t.nickname,n.sex=t.sex,n.intro=t.intro,n.email=t.email,localStorage.setItem("loginResult",l()(e.loginResult))},setAvater:function(e){e.loginResult.user.avater=1,localStorage.setItem("loginResult",l()(e.loginResult))}},actions:{},getters:{sessionId:function(e){return e.loginResult.sessionId},userId:function(e){return e.loginResult.user.userId},authority:function(e){return e.loginResult.user.authority},user:function(e){return e.loginResult.user},chatWebSocket:function(e){return e.chatWebSocket},messageGroup:function(e){return e.messageGroup},messageCount:function(e){return e.messageCount},isChat:function(e){return e.isChat},valueChange:function(e){return e.valueChange}}}),h=t.a=p},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var u=n("VU/8")({name:"App"},r,!1,function(e){n("9uPt")},null,null).exports,a=n("zL8q"),s=n.n(a),l=(n("tvR6"),n("YaEn")),i=n("IcnI");Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var c=["hh:mm","yyyy-MM-dd"];o.default.use(s.a),o.default.config.productionTip=!1,o.default.prototype.$getTimeString=function(e){var t=new Date(e*=1e3),n=new Date;return n.getMonth()==t.getMonth()&&n.getFullYear()==t.getFullYear()?n.getDate()==t.getDate()?t.format(c[0]):n.getDate()==t.getDate()+1?"昨天"+t.format(c[0]):t.format(c[1]):t.format(c[1])},o.default.prototype.$getCountString=function(e){return e>1e3?Math.round(e/100)/10+"K":e},o.default.prototype.$nowTimestamp=function(){return(new Date).getTime()/1e3},o.default.prototype.$userInfo=function(e){return{anonymous:e,user:i.a.getters.user}},o.default.prototype.$avaterUrl=function(e,t){return"/img/"+(e?t:"null")+".png"},o.default.prototype.$questionInfo2ActvityInfo=function(e){if(null!=e.defaultAnswer){var t=e.defaultAnswer.answer;return{info:e,activity:{act:4,userId:t.userId,id:t.answerId,gmtCreate:t.gmtCreate},userInfo:e.defaultAnswer.userInfo}}return{info:e,activity:{act:1,userId:e.question.userId,id:e.question.questionId,gmtCreate:e.question.gmtCreate},userInfo:e.userInfo}},new o.default({el:"#app",router:l.a,store:i.a,components:{App:u},template:"<App/>"})},YaEn:function(e,t,n){"use strict";var o=n("7+uW"),r=n("/ocq");o.default.use(r.a),t.a=new r.a({mode:"hash",routes:[{path:"/",component:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"j7e0"))},redirect:"/index",children:[{path:"/index",iconCls:"el-icon-house",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"mlqX"))}},{path:"/search",iconCls:"el-icon-search",component:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"G7FF"))}},{path:"/develop",iconCls:"el-icon-setting",component:function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"mgYR"))},authority:2},{path:"/question",name:"问题",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"NtIj"))},hidden:!0},{path:"/people/:peopleId",name:"用户",component:function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"3iTu"))},hidden:!0},{path:"/topic/:topic",name:"话题",component:function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,"ie7M"))},hidden:!0},{path:"/setting",name:"设置",component:function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"XWS1"))},hidden:!0}]},{path:"/login",name:"登陆",component:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"lmfZ"))},hidden:!0}]})},tvR6:function(e,t){}},["NHnr"]);