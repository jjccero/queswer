<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gzu.queswer.dao.ReviewDao">
    <insert id="insertReview" useGeneratedKeys="true" keyProperty="rid">
        INSERT INTO t_review (gmt_create, aid, uid, review, reply_rid, deleted)
        VALUES (#{gmt_create}, #{aid}, #{uid}, #{review}, #{reply_rid}, False);
    </insert>
    <select id="selectReviewByRid" resultType="com.gzu.queswer.model.Review">
        SELECT rid,
               gmt_create,
               aid,
               uid,
               IF(deleted = FALSE, review, null) review,
               reply_rid,
               deleted
        FROM t_review WHERE rid=#{rid};
    </select>
    <delete id="deleteReviewByRid">
        UPDATE t_review
        SET deleted=1
        WHERE rid = #{rid};
    </delete>
    <select id="selectRidsByAid" resultType="Long">
        SELECT rid
        FROM t_review
        WHERE aid = #{aid};
    </select>
</mapper>