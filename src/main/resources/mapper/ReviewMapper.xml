<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gzu.queswer.dao.ReviewDao">
    <insert id="insertReview" useGeneratedKeys="true" keyProperty="rId">
        INSERT INTO t_review (gmtCreate, ansId, uId, review, replyRId, deleted)
        VALUES (#{gmtCreate}, #{ansId}, #{uId}, #{review}, #{replyRId}, False);
    </insert>
    <select id="selectReviewByRid" resultType="com.gzu.queswer.model.Review">
        SELECT rId,
               gmtCreate,
               ansId,
               uId,
               IF(deleted = FALSE, review, null) review,
               replyRId,
               deleted
        FROM t_review WHERE rId=#{rId};
    </select>
    <delete id="deleteReviewByRid">
        UPDATE t_review
        SET deleted=1
        WHERE rId = #{rId};
    </delete>
    <select id="selectRidsByAid" resultType="Long">
        SELECT rId
        FROM t_review
        WHERE ansId = #{ansId};
    </select>
</mapper>